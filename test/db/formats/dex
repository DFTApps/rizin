NAME=invalid codesize DEX file
FILE=bins/dex/Call.dex
CMDS=<<EOF
oml
s
EOF
EXPECT=<<EOF
 1 fd: 3 +0x00000160 0x100000160 * 0x10000041b r-x fmap.data
 2 fd: 3 +0x00000000 0x00000000 - 0x0000041b r-- fmap.file
 3 fd: 4 +0x00000000 0x8000000000 - 0x8000000007 r-x vmap.reloc-targets
0x100000160
EOF
RUN

NAME=loading DEX file
FILE=bins/dex/Hello.dex
CMDS=iZ
EXPECT=<<EOF
1000
EOF
RUN

NAME=Checking file size
FILE=bins/dex/HelloSlack.dex
CMDS=<<EOF
%v $s
iZ
EOF
EXPECT=<<EOF
0x800
2048
EOF
RUN

NAME=DEX: entrypoint
FILE=bins/dex/HelloSlack.dex
CMDS=%v entry0
EXPECT=<<EOF
0x1000001c0
EOF
RUN

NAME=DEX dex38.dex ie command
FILE=bins/dex/dex38.dex
CMDS=ie
EXPECT=<<EOF
vaddr       paddr      hvaddr     haddr      type    
-----------------------------------------------------
0x100000f70 0x00000f70 ---------- ---------- program
0x1000010b8 0x000010b8 ---------- ---------- program
0x10000121c 0x0000121c ---------- ---------- program
EOF
RUN

NAME=DEX dex38.dex invoke-polymorphic
FILE=bins/dex/dex38.dex
CMDS=pi 2 @ 0x00125e; pi 3 @ 0x0012da
EXPECT=<<EOF
invoke-polymorphic {v1, v2, v3}, Ljava/lang/invoke/MethodHandle;->invoke([Ljava/lang/Object;)Ljava/lang/Object;, (II)Ljava/lang/Object;
move-result-object v1
invoke-polymorphic {v0, v1, v2}, Ljava/lang/invoke/MethodHandle;->invoke([Ljava/lang/Object;)Ljava/lang/Object;, (Ljava/lang/String;I)Ljava/lang/Object;
move-result-object v0
return-object v0
EOF
RUN

NAME=DEX dex38.dex invoke-custom
FILE=bins/dex/dex38.dex
CMDS=pi 3 @ 0x00112c
EXPECT=<<EOF
invoke-custom {v0, v1}, call_site+0
move-result-object v0
return-object v0
EOF
RUN

NAME=DEX Hello.dex classes (ic, icf & icm command)
FILE=bins/dex/Hello.dex
CMDS=<<EOF
ic
icf 'Hello'
icm 'Hello'
EOF
EXPECT=<<EOF
address    min         max         name  super  
------------------------------------------------
0x00000174 0x1000001a4 0x10000021e Hello Object
address     index class flags name type   
------------------------------------------
0x100000336 0     Hello P     who  String
address     index class flags name                
--------------------------------------------------
0x1000001a4 0     Hello pC    void <init>(String)
0x1000001c0 1     Hello sp    void main(String[])
0x1000001e8 2     Hello p     void say()
EOF
RUN

NAME=DEX Hello.dex single class (icf & icm Hello)
FILE=bins/dex/Hello.dex
CMDS=<<EOF
icf 'Hello'
icm 'Hello'
EOF
EXPECT=<<EOF
address     index class flags name type   
------------------------------------------
0x100000336 0     Hello P     who  String
address     index class flags name                
--------------------------------------------------
0x1000001a4 0     Hello pC    void <init>(String)
0x1000001c0 1     Hello sp    void main(String[])
0x1000001e8 2     Hello p     void say()
EOF
RUN

NAME=DEX Hello.dex classes quiet (icq command)
FILE=bins/dex/Hello.dex
CMDS=icq
EXPECT=<<EOF
0x00000174 [0x1000001a4 - 0x10000021e] Hello Object
EOF
RUN

NAME=DEX Hello.dex method flags (JSON) (icj)
FILE=bins/dex/Hello.dex
CMDS=<<EOF
icj~{[0].methods[1].flags[0]}
icj~{[0].methods[1].flags[1]}
EOF
EXPECT=<<EOF
static
public
EOF
RUN

NAME=DEX Hello.dex method flags (rizin commands) (ic*)
FILE=bins/dex/Hello.dex
CMDS=ic*~main
EXPECT=<<EOF
"f method.public.static.Hello.void_main_String @ 0x1000001c0"
EOF
RUN

NAME=DEX HelloWorld.dex symbols, fields and statics (isq command)
FILE=bins/dex/HelloWorld.dex
CMDS=isq
EXPECT=<<EOF
0x1000004f0 0 Hello localVar2
0x1000004f2 0 Hello localVar
0x100000238 20 Hello void <init>()
0x10000025c 34 Hello void main(String[])
0x100000290 84 Hello void foo(int)
0x100000506 0 World worldVar
0x100000508 0 World worldVar2
0x1000002f4 20 World void <init>()
0x100000318 68 World void foo(int)
0x00000000 0 java.lang.System imp.out
0x8000000000 2 java.io.PrintStream void println(String)
0x8000000002 2 java.lang.Integer void <init>(int)
0x8000000004 2 java.lang.Integer String toString()
0x8000000006 2 java.lang.Object void <init>()
0x8000000008 2 java.lang.StringBuilder void <init>()
0x800000000a 2 java.lang.StringBuilder StringBuilder append(String)
0x800000000c 2 java.lang.StringBuilder String toString()
EOF
RUN

NAME=DEX HelloWorld.dex flags (fl command)
FILE=bins/dex/HelloWorld.dex
CMDS=fl
EXPECT=<<EOF
0x00000000 1460 section.file
0x00000000 0 sym.System.out
0x000001e8 1 class.Hello
0x00000208 1 class.World
0x100000228 908 section.data
0x100000238 20 sym.Hello.void__init
0x100000238 1 method.public.constructor.Hello.void__init
0x10000025c 256 main
0x10000025c 1 entry0
0x10000025c 34 sym.Hello.void_main_String
0x10000025c 1 method.public.static.Hello.void_main_String
0x100000290 84 sym.Hello.void_foo_int
0x100000290 1 method.public.Hello.void_foo_int
0x1000002f4 20 sym.World.void__init
0x1000002f4 1 method.public.constructor.World.void__init
0x100000318 68 sym.World.void_foo_int
0x100000318 1 method.public.World.void_foo_int
0x100000372 6 str.init
0x10000037a 6 str.Findus
0x100000382 10 str.Hello.java
0x10000038e 1 str.I
0x100000391 1 str.L
0x100000394 7 str.LHello
0x10000039d 2 str.LL
0x1000003a1 7 str.LWorld
0x1000003aa 21 str.Ljava_io_PrintStream
0x1000003c1 19 str.Ljava_lang_Integer
0x1000003d6 18 str.Ljava_lang_Object
0x1000003fe 25 str.Ljava_lang_StringBuilder
0x100000419 18 str.Ljava_lang_System
0x10000042d 1 str.V
0x100000430 2 str.VI
0x100000434 2 str.VL
0x100000438 10 str.World.java
0x100000444 19 str.Ljava_lang_String
0x100000459 6 str.append
0x100000466 6 str.foo
0x10000046e 8 str.localVar
0x100000478 9 str.localVar2
0x100000483 4 str.main
0x100000489 3 str.out
0x10000048e 7 str.println
0x100000497 8 str.toString
0x1000004a1 8 str.world
0x1000004ab 8 str.worldVar
0x1000004b5 9 str.worldVar2
0x1000004f0 0 sym.Hello.localVar2
0x1000004f2 0 sym.Hello.localVar
0x100000506 0 sym.World.worldVar
0x100000508 0 sym.World.worldVar2
0x8000000000 14 section.reloc_targets
0x8000000000 2 sym.java.io.PrintStream.void_println_String
0x8000000002 2 sym.Integer.void__init__int
0x8000000004 2 sym.Integer.String_toString
0x8000000006 2 sym.Object.void__init
0x8000000008 2 sym.StringBuilder.void__init
0x800000000a 2 sym.StringBuilder.StringBuilder_append_String
0x800000000c 2 sym.StringBuilder.String_toString
EOF
RUN

NAME=DEX HelloWorld.dex imports (ii command)
FILE=bins/dex/HelloWorld.dex
CMDS=ii
EXPECT=<<EOF
nth vaddr      bind type  lib                     name                                       
---------------------------------------------------------------------------------------------
0   0x00000000 WEAK FIELD java.lang.System        System.out
1   ---------- WEAK FUNC  java.io.PrintStream     void java.io.PrintStream.println(String)
2   ---------- WEAK FUNC  java.lang.Integer       void Integer.<init>(int)
3   ---------- WEAK FUNC  java.lang.Integer       String Integer.toString()
4   ---------- WEAK FUNC  java.lang.Object        void Object.<init>()
5   ---------- WEAK FUNC  java.lang.StringBuilder void StringBuilder.<init>()
6   ---------- WEAK FUNC  java.lang.StringBuilder StringBuilder StringBuilder.append(String)
7   ---------- WEAK FUNC  java.lang.StringBuilder String StringBuilder.toString()
EOF
RUN

NAME=DEX HelloWorld.dex exports (iE command)
FILE=bins/dex/HelloWorld.dex
CMDS=iE
EXPECT=<<EOF
nth paddr      vaddr       bind   type  size lib   name                
-----------------------------------------------------------------------
1   0x000004f0 0x1000004f0 GLOBAL FIELD 0    Hello localVar2
2   0x0000025c 0x10000025c GLOBAL METH  34   Hello void main(String[])
EOF
RUN

NAME=DEX HelloWorld.dex pi command
FILE=bins/dex/HelloWorld.dex
CMDS=pi 1 @ 0x240; pi 1 @ 0x246; pi 1 @ 0x25c; pi 1 @ 0x264; pi 1 @ 0x276; pi 1 @ 0x026a; pi 1 @ 0x0294; pi 1 @ 0x0298
EXPECT=<<EOF
iput v0, v1, LHello;->localVar I
sput v0, LHello;->localVar2 I
sget-object v0, Ljava/lang/System;->out Ljava/io/PrintStream;
invoke-virtual {v0, v1}, Ljava/io/PrintStream;->println(Ljava/lang/String;)V
invoke-virtual {v0, v1}, LHello;->foo(I)V
new-instance v0, LHello;
new-instance v1, Ljava/lang/StringBuilder;
invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V
EOF
RUN

NAME=DEX HelloWorld.dex debug info
BROKEN=1
FILE=bins/dex/HelloWorld.dex
CMDS=e io.va=0; e asm.bytes=1; pd 1 @0x00000290|grep Hello.java; pd 1 @0x000002f4|grep World.java; pd 1 @0x00000318|grep World.java;
EXPECT=<<EOF
            0x00000290      62000400       sget-object v0, Ljava/lang/System;->out Ljava/io/PrintStream; ; Hello.java:9 ; 0x180
            0x000002f4      701008000100   invoke-direct {v1}, Ljava/lang/Object.<init>()V ; 0x8 ; World.java:5
            0x00000318      62000400       sget-object v0, Ljava/lang/System;->out Ljava/io/PrintStream; ; World.java:11 ; 0x180
EOF
RUN

NAME=DEX HelloWorld.dex debug info CL
BROKEN=1
FILE=bins/dex/HelloWorld.dex
CMDS=<<EOF
ix
echo --
ix.@0x000002f4
echo --
ix.@0x00000318
echo --
ix~?
EOF
EXPECT=<<EOF
0x00000238	Hello.java	4
0x0000023b	Hello.java	5
0x0000023e	Hello.java	6
0x00000241	Hello.java	7
0x0000025c	Hello.java	14
0x00000263	Hello.java	15
0x00000268	Hello.java	16
0x0000026c	Hello.java	17
0x00000290	Hello.java	9
0x000002b1	Hello.java	10
0x000002b9	Hello.java	11
0x000002f4	World.java	5
0x000002f7	World.java	6
0x000002fa	World.java	7
0x000002fd	World.java	8
0x00000318	World.java	11
0x00000339	World.java	12
--
0x000002f4	World.java	5
--
0x00000318	World.java	11
--
17
EOF
RUN

NAME=DEX HelloWorld.dex dexdump
BROKEN=1
FILE=bins/dex/HelloWorld.dex
CMDS=iHH
EXPECT=<<EOF
DEX file header:
magic               : 'dex\n035\0'
checksum            : 190ab819
signature           : 86db...7869
file_size           : 1460
header_size         : 112
link_size           : 0
link_off            : 0 (0x000000)
string_ids_size     : 31
string_ids_off      : 112 (0x000070)
type_ids_size       : 11
type_ids_off        : 236 (0x0000ec)
proto_ids_size      : 6
proto_ids_off       : 280 (0x000118)
field_ids_size      : 5
field_ids_off       : 352 (0x000160)
method_ids_size     : 12
method_ids_off      : 392 (0x000188)
class_defs_size     : 2
class_defs_off      : 488 (0x0001e8)
data_size           : 908
data_off            : 552 (0x000228)

Class #0            -
  Class descriptor  : 'LHello;'
  Access flags      : 0x0001 (PUBLIC)
  Superclass        : 'Ljava/lang/Object;'
  Interfaces        -
  Static fields     -
    #0              : (in LHello;)
      name          : 'localVar2'
      type          : 'I'
      access        : 0x0008 (STATIC)
  Instance fields   -
    #0              : (in LHello;)
      name          : 'localVar'
      type          : 'I'
      access        : 0x0000 ()
  Direct methods    -
    #0              : (in LHello;)
      name          : '<init>'
      type          : '()V'
      access        : 0x10001 (PUBLIC CONSTRUCTOR)
      code          -
      registers     : 2
      ins           : 1
      outs          : 1
      insns size    : 10 16-bit code units
      catches       : (none)
      positions     :
        0x0000 line=4
        0x0003 line=5
        0x0006 line=6
        0x0009 line=7
      locals        :
        0x0000 - 0x000a reg=1 this LHello;
    #1              : (in LHello;)
      name          : 'main'
      type          : '([Ljava/lang/String;)V'
      access        : 0x0009 (PUBLIC STATIC)
      code          -
      registers     : 3
      ins           : 1
      outs          : 2
      insns size    : 17 16-bit code units
      catches       : (none)
      positions     :
        0x0000 line=14
        0x0007 line=15
        0x000c line=16
        0x0010 line=17
      locals        :
  Virtual methods   -
    #0              : (in LHello;)
      name          : 'foo'
      type          : '(I)V'
      access        : 0x0001 (PUBLIC)
      code          -
      registers     : 5
      ins           : 2
      outs          : 2
      insns size    : 42 16-bit code units
      catches       : (none)
      positions     :
        0x0000 line=9
        0x0021 line=10
        0x0029 line=11
      locals        :
        0x0000 - 0x002a reg=3 this LHello;
  source_file_idx   : 2 (Hello.java)

Class #1            -
  Class descriptor  : 'LWorld;'
  Access flags      : 0x0001 (PUBLIC)
  Superclass        : 'Ljava/lang/Object;'
  Interfaces        -
  Static fields     -
  Instance fields   -
    #0              : (in LWorld;)
      name          : 'worldVar'
      type          : 'I'
      access        : 0x0000 ()
    #1              : (in LWorld;)
      name          : 'worldVar2'
      type          : 'I'
      access        : 0x0000 ()
  Direct methods    -
    #0              : (in LWorld;)
      name          : '<init>'
      type          : '()V'
      access        : 0x10001 (PUBLIC CONSTRUCTOR)
      code          -
      registers     : 2
      ins           : 1
      outs          : 1
      insns size    : 10 16-bit code units
      catches       : (none)
      positions     :
        0x0000 line=5
        0x0003 line=6
        0x0006 line=7
        0x0009 line=8
      locals        :
        0x0000 - 0x000a reg=1 this LWorld;
  Virtual methods   -
    #0              : (in LWorld;)
      name          : 'foo'
      type          : '(I)V'
      access        : 0x0001 (PUBLIC)
      code          -
      registers     : 5
      ins           : 2
      outs          : 2
      insns size    : 34 16-bit code units
      catches       : (none)
      positions     :
        0x0000 line=11
        0x0021 line=12
      locals        :
        0x0000 - 0x0022 reg=3 this LWorld;
  source_file_idx   : 17 (World.java)

EOF
RUN

NAME=DEX radare2installer.dex classes (is getProper)
FILE=bins/dex/org.radare.radare2installer.dex
CMDS=ii~getProper
EXPECT=<<EOF
402 ---------- WEAK FUNC  java.lang.System                                 String System.getProperty(String)
403 ---------- WEAK FUNC  java.lang.System                                 String System.getProperty(String, String)
EOF
RUN

NAME=DEX radare2installer.dex classes (ic command)
FILE=bins/dex/org.radare.radare2installer.dex
CMDS=ic
EXPECT=<<EOF
address    min          max          name                                                             super                                    
-----------------------------------------------------------------------------------------------------------------------------------------------
0x00007890 0x10000c6c0  0x10000cd2e  com.ice.tar.FastTarStream                                        Object
0x000078b0 0x10000cd40  0x10000cd60  com.ice.tar.InvalidHeaderException                               java.io.IOException
0x000078d0 0x10000cd70  0x10000db74  com.ice.tar.TarArchive                                           Object
0x000078f0 0x10000dba8  0x10000e3bc  com.ice.tar.TarBuffer                                            Object
0x00007910 0x10000e3cc  0x10000f29a  com.ice.tar.TarEntry                                             Object
0x00007930 0x10000f2ac  0x10000f394  com.ice.tar.TarEntryEnumerator                                   Object
0x00007950 0x10000f3a4  0x10000f90e  com.ice.tar.TarHeader                                            Object
0x00007970 0x800000011a 0x8000000120 com.ice.tar.TarInputStream$EntryFactory                          Object
0x00007990 0x10000f920  0x10000ff74  com.ice.tar.TarInputStream                                       java.io.FilterInputStream
0x000079b0 0x10000ff84  0x100010442  com.ice.tar.TarOutputStream                                      java.io.FilterOutputStream
0x000079d0 0x8000000120 0x8000000122 com.ice.tar.TarProgressDisplay                                   Object
0x000079f0 0x100010454  0x100010484  com.ice.tar.TarTransFileTyper                                    Object
0x00007a10 0x100010494  0x10001049c  com.stericson.RootTools.BuildConfig                              Object
0x00007a30 0x1000104ac  0x8000000124 com.stericson.RootTools.Command                                  Object
0x00007a50 0x1000107d0  0x10001117c  com.stericson.RootTools.Executer$Worker                          Thread
0x00007a70 0x10001128c  0x1000113ce  com.stericson.RootTools.Executer                                 Object
0x00007a90 0x800000012c 0x8000000140 com.stericson.RootTools.IResult                                  Object
0x00007ab0 0x100011410  0x100011862  com.stericson.RootTools.Installer                                Object
0x00007ad0 0x100011874  0x10001399c  com.stericson.RootTools.InternalMethods                          Object
0x00007af0 0x1000139e0  0x100013a5c  com.stericson.RootTools.InternalVariables                        Object
0x00007b10 0x100013a6c  0x100013b50  com.stericson.RootTools.Mount                                    Object
0x00007b30 0x100013b60  0x100013c86  com.stericson.RootTools.Permissions                              Object
0x00007b50 0x100013c98  0x100014130  com.stericson.RootTools.Remounter                                Object
0x00007b70 0x100014170  0x10001481a  com.stericson.RootTools.RootTools                                Object
0x00007b90 0x10001482c  0x100014834  com.stericson.RootTools.RootToolsException                       Exception
0x00007bb0 0x100014844  0x10001491e  com.stericson.RootTools.Runner                                   Thread
0x00007bd0 0x10001494c  0x100014980  com.stericson.RootTools.SanityCheckRootTools$1                   Object
0x00007bf0 0x100014990  0x1000153d0  com.stericson.RootTools.SanityCheckRootTools$SanityCheckThread   Thread
0x00007c10 0x100015478  0x100015560  com.stericson.RootTools.SanityCheckRootTools$TestHandler         android.os.Handler
0x00007c30 0x100015570  0x100015740  com.stericson.RootTools.SanityCheckRootTools                     android.app.Activity
0x00007c50 0x100015750  0x10001578c  com.stericson.RootTools.Shell$1                                  Object
0x00007c70 0x1000157ac  0x1000157fa  com.stericson.RootTools.Shell$2                                  Object
0x00007c90 0x10001581c  0x1000158fa  com.stericson.RootTools.Shell$Worker                             Thread
0x00007cb0 0x100015924  0x10001615a  com.stericson.RootTools.Shell                                    Object
0x00007cd0 0x10001616c  0x1000161aa  com.stericson.RootTools.Symlink                                  Object
0x00007cf0 0x1000161bc  0x100016438  com.sun.activation.registries.LineTokenizer                      Object
0x00007d10 0x100016448  0x1000164f2  com.sun.activation.registries.MailcapEntry                       Object
0x00007d30 0x100016504  0x100016f12  com.sun.activation.registries.MailcapFile                        Object
0x00007d50 0x100016f24  0x100016f44  com.sun.activation.registries.MailcapParseException              Exception
0x00007d70 0x100016f54  0x10001774a  com.sun.activation.registries.MailcapTokenizer                   Object
0x00007d90 0x10001775c  0x1000177e8  com.sun.activation.registries.MimeTypeEntry                      Object
0x00007db0 0x1000177f8  0x100017c72  com.sun.activation.registries.MimeTypeFile                       Object
0x00007dd0 0x100017c84  0x100017d22  com.sun.activation.viewers.ImageViewerCanvas                     java.awt.Canvas
0x00007df0 0x100017d34  0x100017f3a  javax.activation.ActivationDataFlavor                            java.awt.datatransfer.DataFlavor
0x00007e10 0x100017f4c  0x100017ff6  javax.activation.CommandInfo                                     Object
0x00007e30 0x100018008  0x8000000424 javax.activation.CommandMap                                      Object
0x00007e50 0x8000000424 0x8000000426 javax.activation.CommandObject                                   Object
0x00007e70 0x8000000426 0x800000042e javax.activation.DataContentHandler                              Object
0x00007e90 0x800000042e 0x8000000430 javax.activation.DataContentHandlerFactory                       Object
0x00007eb0 0x10001811c  0x10001818c  javax.activation.DataHandler$1                                   Object
0x00007ed0 0x1000181c4  0x10001895a  javax.activation.DataHandler                                     Object
0x00007ef0 0x8000000430 0x8000000438 javax.activation.DataSource                                      Object
0x00007f10 0x10001896c  0x800000043c javax.activation.FileTypeMap                                     Object
0x00007f30 0x100018a80  0x100018fca  javax.activation.MimeType                                        Object
0x00007f50 0x100018fdc  0x100019528  javax.activation.MimeTypeParameterList                           Object
0x00007f70 0x100019538  0x100019558  javax.activation.MimeTypeParseException                          Exception
0x00007f90 0x100019568  0x100019588  javax.activation.UnsupportedDataTypeException                    java.io.IOException
0x00007fb0 0x100019598  0x10001987c  org.radare.r2pipe.R2Pipe                                         Object
0x00007fd0 0x10001988c  0x100019934  org.radare.radare2installer.BootReceiver                         android.content.BroadcastReceiver
0x00007ff0 0x100019944  0x10001994c  org.radare.radare2installer.BuildConfig                          Object
0x00008010 0x10001995c  0x100019a56  org.radare.radare2installer.ConsoleActivity$1                    Object
0x00008030 0x100019a78  0x100019b10  org.radare.radare2installer.ConsoleActivity$2                    Object
0x00008050 0x100019b20  0x100019b48  org.radare.radare2installer.ConsoleActivity$3                    Object
0x00008070 0x100019b58  0x100019e9e  org.radare.radare2installer.ConsoleActivity                      android.app.Activity
0x00008090 0x100019ec0  0x100019eec  org.radare.radare2installer.LaunchActivity$1                     Object
0x000080b0 0x100019efc  0x100019f28  org.radare.radare2installer.LaunchActivity$2                     Object
0x000080d0 0x100019f38  0x10001a510  org.radare.radare2installer.LaunchActivity                       android.app.Activity
0x000080f0 0x10001a520  0x10001a7b6  org.radare.radare2installer.LauncherActivity                     android.app.Activity
0x00008110 0x10001a7c8  0x10001a820  org.radare.radare2installer.MainActivity$1                       Object
0x00008130 0x10001a830  0x10001aa4a  org.radare.radare2installer.MainActivity$2                       Object
0x00008150 0x10001aa5c  0x10001aab0  org.radare.radare2installer.MainActivity$3                       Object
0x00008170 0x10001aac0  0x10001ab1a  org.radare.radare2installer.MainActivity$4$1$1                   Object
0x00008190 0x10001ab2c  0x10001c3ba  org.radare.radare2installer.MainActivity$4$1                     Object
0x000081b0 0x10001c3e8  0x10001c562  org.radare.radare2installer.MainActivity$4                       Object
0x000081d0 0x10001c590  0x10001c5fa  org.radare.radare2installer.MainActivity$5                       Object
0x000081f0 0x10001c60c  0x10001c65e  org.radare.radare2installer.MainActivity$6                       Object
0x00008210 0x10001c670  0x10001cf9e  org.radare.radare2installer.MainActivity                         android.app.Activity
0x00008230 0x10001cfb0  0x10001d006  org.radare.radare2installer.PathReceiver                         android.content.BroadcastReceiver
0x00008250 0x10001d018  0x10001d264  org.radare.radare2installer.PubKeyManager                        Object
0x00008270 0x10001d274  0x10001d27c  org.radare.radare2installer.R$array                              Object
0x00008290 0x10001d28c  0x10001d294  org.radare.radare2installer.R$attr                               Object
0x000082b0 0x10001d2a4  0x10001d2ac  org.radare.radare2installer.R$drawable                           Object
0x000082d0 0x10001d2bc  0x10001d2c4  org.radare.radare2installer.R$id                                 Object
0x000082f0 0x10001d2d4  0x10001d2dc  org.radare.radare2installer.R$layout                             Object
0x00008310 0x10001d2ec  0x10001d2f4  org.radare.radare2installer.R$string                             Object
0x00008330 0x10001d304  0x10001d30c  org.radare.radare2installer.R$style                              Object
0x00008350 0x10001d31c  0x10001d324  org.radare.radare2installer.R$xml                                Object
0x00008370 0x10001d334  0x10001d33c  org.radare.radare2installer.R                                    Object
0x00008390 0x10001d34c  0x10001d376  org.radare.radare2installer.SettingsActivity                     android.preference.PreferenceActivity
0x000083b0 0x000083b0   0x000083b0   org.radare.radare2installer.UpdateCheckerService$1               Object
0x000083d0 0x10001d388  0x10001d588  org.radare.radare2installer.UpdateCheckerService$PollTask        android.os.AsyncTask
0x000083f0 0x10001d598  0x10001d6ee  org.radare.radare2installer.UpdateCheckerService                 android.app.Service
0x00008410 0x10001d700  0x10001dea0  org.radare.radare2installer.Utils                                Object
0x00008430 0x00008430   0x00008430   org.radare.radare2installer.WebActivity$1                        Object
0x00008450 0x10001dec0  0x10001df9a  org.radare.radare2installer.WebActivity$RadareWebViewClient      android.webkit.WebViewClient
0x00008470 0x10001dfac  0x10001e5e8  org.radare.radare2installer.WebActivity                          android.app.Activity
0x00008490 0x10001e608  0x10001e83c  com.ice.tar.TarGzOutputStream                                    com.ice.tar.TarOutputStream
0x000084b0 0x10001e84c  0x10001e8ac  com.ice.tar.TarInputStream$EntryAdapter                          Object
0x000084d0 0x10001e8bc  0x10001f498  com.ice.tar.tar                                                  Object
0x000084f0 0x10001f4a8  0x10001f542  com.stericson.RootTools.CommandCapture                           com.stericson.RootTools.Command
0x00008510 0x10001f554  0x10001f582  com.stericson.RootTools.InternalMethods$1                        com.stericson.RootTools.Command
0x00008530 0x10001f594  0x10001f5f4  com.stericson.RootTools.InternalMethods$2                        com.stericson.RootTools.Command
0x00008550 0x10001f604  0x10001f64c  com.stericson.RootTools.InternalMethods$3                        com.stericson.RootTools.Command
0x00008570 0x10001f65c  0x10001f6e6  com.stericson.RootTools.InternalMethods$4                        com.stericson.RootTools.Command
0x00008590 0x10001f6f8  0x10001f79a  com.stericson.RootTools.InternalMethods$5                        com.stericson.RootTools.Command
0x000085b0 0x10001f7ac  0x10001f892  com.stericson.RootTools.InternalMethods$6                        com.stericson.RootTools.Command
0x000085d0 0x10001f8c0  0x10001f92a  com.stericson.RootTools.InternalMethods$7                        com.stericson.RootTools.Command
0x000085f0 0x10001f93c  0x10001f984  com.stericson.RootTools.InternalMethods$8                        com.stericson.RootTools.Command
0x00008610 0x10001f994  0x10001fa14  com.stericson.RootTools.InternalMethods$9                        com.stericson.RootTools.Command
0x00008630 0x10001fa24  0x8000000152 com.stericson.RootTools.RootTools$Result                         Object
0x00008650 0x10001fb30  0x10001fcd8  com.sun.activation.viewers.ImageViewer                           java.awt.Panel
0x00008670 0x10001fce8  0x10001ffae  com.sun.activation.viewers.TextEditor                            java.awt.Panel
0x00008690 0x10001ffc0  0x1000200da  com.sun.activation.viewers.TextViewer                            java.awt.Panel
0x000086b0 0x1000200ec  0x100020176  javax.activation.DataHandlerDataSource                           Object
0x000086d0 0x100020188  0x1000202e6  javax.activation.DataSourceDataContentHandler                    Object
0x000086f0 0x1000202f8  0x1000203f6  javax.activation.FileDataSource                                  Object
0x00008710 0x100020408  0x100020be0  javax.activation.MailcapCommandMap                               javax.activation.CommandMap
0x00008730 0x100020c04  0x100020f7a  javax.activation.MimetypesFileTypeMap                            javax.activation.FileTypeMap
0x00008750 0x100020fa0  0x1000210f2  javax.activation.ObjectDataContentHandler                        Object
0x00008770 0x100021104  0x1000211fe  javax.activation.URLDataSource                                   Object
0x00008790 0x100021210  0x100021262  org.radare.radare2installer.Utils$1                              com.stericson.RootTools.Command
0x000087b0 0x100021274  0x1000212f6  com.stericson.RootTools.InternalMethods$10                       com.stericson.RootTools.RootTools$Result
0x000087d0 0x100021308  0x100021446  com.stericson.RootTools.InternalMethods$11                       com.stericson.RootTools.RootTools$Result
0x000087f0 0x100021458  0x100021554  com.stericson.RootTools.SanityCheckRootTools$SanityCheckThread$1 com.stericson.RootTools.RootTools$Result
0x00008810 0x100021564  0x100021660  com.stericson.RootTools.SanityCheckRootTools$SanityCheckThread$2 com.stericson.RootTools.RootTools$Result
EOF
RUN

NAME=DEX radare2installer.dex classes
FILE=bins/dex/org.radare.radare2installer.dex
CMDS=<<EOF
icf 'com.stericson.RootTools.Installer'
icm 'com.stericson.RootTools.Installer'
EOF
EXPECT=<<EOF
address     index class                             flags name            type                    
--------------------------------------------------------------------------------------------------
0x10000a4b2 0     com.stericson.RootTools.Installer sPf   BOGUS_FILE_NAME String
0x10000a4b5 1     com.stericson.RootTools.Installer sPf   LOG_TAG         String
0x10000a4b7 2     com.stericson.RootTools.Installer P     context         android.content.Context
0x10000a4ba 3     com.stericson.RootTools.Installer P     filesPath       String
address     index class                             flags name                                       
-----------------------------------------------------------------------------------------------------
0x100011410 0     com.stericson.RootTools.Installer pC    void <init>(android.content.Context)
0x100011440 1     com.stericson.RootTools.Installer r     boolean installBinary(int, String, String)
0x100011814 2     com.stericson.RootTools.Installer r     boolean isBinaryInstalled(String)
EOF
RUN

NAME=DEX test.dex val
FILE=bins/dex/test.dex
CMDS=e asm.bytes=true; ao~val[1];
EXPECT=<<EOF
0x00000021
EOF
RUN

NAME=DEX test.dex
FILE=bins/dex/test.dex
CMDS=e asm.bytes=true; pd 1 @ 0x000001c4;
EXPECT=<<EOF
            0x000001c4      1234           const/4 v4, 0x3
EOF
RUN

NAME=FakeMultiDex.apk
FILE=apk://bins/dex/FakeMultiDex.apk
CMDS=<<EOF
oml
ol
EOF
EXPECT=<<EOF
 1 fd: 4 +0x00000194 0x100000194 - 0x1000003e7 r-x fmap.data
 2 fd: 4 +0x00000000 0x00000000 - 0x000003e7 r-- fmap.file
 3 fd: 5 +0x00000000 0x8000000000 - 0x8000000009 r-x vmap.reloc-targets
 4 fd: 3 +0x00000194 0x100010194 * 0x1000103e7 r-x fmap.data
 5 fd: 3 +0x00000000 0x00010000 - 0x000103e7 r-- fmap.file
 6 fd: 6 +0x00000000 0x8000010000 - 0x8000010009 r-x vmap.reloc-targets
 3 - r-x 0x00000800 classes2.dex
 4 * r-x 0x000003e8 classes.dex
 5 - r-x 0x0000000a vfile://0/reloc-targets
 6 - r-x 0x0000000a vfile://1/reloc-targets
EOF
RUN

NAME=dexdump like output of the dex data 
FILE=bins/dex/Hello.dex
CMDS=dexs
EXPECT=<<EOF
DEX file header:
version             : Android 3.2 (API level 13 and earlier)
checksum            : 1b1f79b5
signature           : 3c99...7f13
file_size           : 1000
header_size         : 112
link_size           : 0
link_off            : 0 (0x000000)
string_ids_size     : 22
string_ids_off      : 112 (0x000070)
type_ids_size       : 8
type_ids_off        : 200 (0x0000c8)
proto_ids_size      : 5
proto_ids_off       : 232 (0x0000e8)
field_ids_size      : 2
field_ids_off       : 292 (0x000124)
method_ids_size     : 8
method_ids_off      : 308 (0x000134)
class_defs_size     : 1
class_defs_off      : 372 (0x000174)
data_size           : 596
data_off            : 404 (0x000194)

Class #0 header:
offset              : 0x174
class_idx           : 0
access_flags        : 1 (0x0001)
superclass_idx      : 2
interfaces_off      : 0 (0x000000)
source_file_idx     : 2
annotations_off     : 0 (0x000000)
class_data_off      : 818 (0x000332)
static_values_offset: 0 (0x000000)
static_fields_size  : 0
instance_fields_size: 1
direct_methods_size : 2
virtual_methods_size: 1

Class #0            -
  Class descriptor  : 'LHello;'
  Access flags      : 0x0001 (PUBLIC)
  Superclass        : 'Ljava/lang/Object;'
  Interfaces        -
  Static fields     -
  Instance fields   -
    #0             : (in LHello;)
      name          : 'who'
      type          : 'Ljava/lang/String;'
      access        : 0x0002 (PRIVATE)
  Direct methods    -
    #0             : (in LHello;)
      name          : '<init>'
      type          : '(Ljava/lang/String;)V'
      access        : 0x10001 (PUBLIC CONSTRUCTOR)
      method_idx    : 0
      code          : (available)
    #1             : (in LHello;)
      name          : 'main'
      type          : '([Ljava/lang/String;)V'
      access        : 0x0009 (PUBLIC STATIC)
      method_idx    : 1
      code          : (available)
  Virtual methods   -
    #0             : (in LHello;)
      name          : 'say'
      type          : '()V'
      access        : 0x0001 (PUBLIC)
      method_idx    : 2
      code          : (available)
EOF
RUN


NAME=dexdump like output of the dex exportable symbols (public/protected) 
FILE=bins/dex/Hello.dex
CMDS=dexe
EXPECT=<<EOF
Class #0            -
  Class descriptor  : 'LHello;'
  Access flags      : 0x0001 (PUBLIC)
  Superclass        : 'Ljava/lang/Object;'
  Interfaces        -
  Static fields     -
  Instance fields   -
  Direct methods    -
    #0             : (in LHello;)
      name          : '<init>'
      type          : '(Ljava/lang/String;)V'
      access        : 0x10001 (PUBLIC CONSTRUCTOR)
      method_idx    : 0
      code          : (available)
    #1             : (in LHello;)
      name          : 'main'
      type          : '([Ljava/lang/String;)V'
      access        : 0x0009 (PUBLIC STATIC)
      method_idx    : 1
      code          : (available)
  Virtual methods   -
    #0             : (in LHello;)
      name          : 'say'
      type          : '()V'
      access        : 0x0001 (PUBLIC)
      method_idx    : 2
      code          : (available)
EOF
RUN
