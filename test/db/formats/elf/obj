NAME=obj entry
FILE=bins/elf/analysis/test.obj
BROKEN=1
CMDS=ie~addr
EXPECT=<<EOF
vaddr=0x00000000 paddr=0x00000040 baddr=0x00000000 laddr=0x00000000 haddr=0x00000018 type=program
EOF
EXPECT_ERR=<<EOF
EOF
RUN

NAME=obj entry
FILE=bins/elf/analysis/test.obj
BROKEN=1
CMDS=ie~addr
EXPECT=<<EOF
vaddr=0x00200000 paddr=0x00000040 baddr=0x00200000 laddr=0x00000000 haddr=0x00000018 type=program
EOF
RUN

NAME=obj main address
FILE=bins/elf/analysis/test.obj
BROKEN=1
CMDS=%v sym.main
EXPECT=<<EOF
0x10
EOF
RUN

NAME=obj main address
FILE=bins/elf/analysis/test.obj
BROKEN=1
CMDS=%v sym.main
EXPECT=<<EOF
0x200010
EOF
RUN

NAME=obj main
FILE=bins/elf/analysis/test.obj
BROKEN=1
CMDS=pi 3@ sym.main
EXPECT=<<EOF
push rbp
mov rbp, rsp
call 0x19
EOF
RUN

NAME=obj main baddr
FILE=bins/elf/analysis/test.obj
BROKEN=1
CMDS=pi 3@sym.main
EXPECT=<<EOF
push rbp
mov rbp, rsp
call 0x200019
EOF
RUN

NAME=obj function names with .L0 symbols
FILE=bins/elf/sbi_bitops.o
CMDS=<<EOF
aa
afl
EOF
EXPECT=<<EOF
0x08000040   24 154          sym.find_first_bit
0x080000da   24 154          sym.find_first_zero_bit
0x08000174   19 152          sym.find_last_bit
0x0800020c   28 204          sym.find_next_bit
0x080002d8   28 216          sym.find_next_zero_bit
EOF
RUN
